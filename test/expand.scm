(import (srfi srfi-64) (thinker data expand) (srfi srfi-69) (thinker exn contract) (thinker exn internal))

(test-begin "expand")
(install-connective! '=> (lambda (a b) `(or (not ,(expand-proposition a)) ,(expand-proposition b))))
(install-connective! '- (lambda (_) 1))
(test-assert (equal? '(or (not "a") "b") (expand-proposition '(=> "a" "b"))))
(test-error &contract-error (install-connective! 'and (lambda () "")))
(test-error &internal-error (expand-proposition '(<=> "A" "B")))
(test-error &contract-error (expand-proposition '(- "A")))
(test-end "expand")